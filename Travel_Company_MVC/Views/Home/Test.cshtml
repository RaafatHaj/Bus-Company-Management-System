@section Styles {



    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="" />
}
<button onclick="ClikckPoint(pins[0], cities[0]) ">Click</button>
<button onclick="ClikckPoint(pins[1], cities[1]) ">Click</button>
<button onclick="ClikckPoint(pins[2], cities[2]) ">Click</button>
<button onclick="ClikckPoint(pins[3], cities[3]) ">Click</button>
<button onclick="ClikckPoint(pins[4], cities[4]) ">Click</button>
<button onclick="ClikckPoint(pins[5], cities[5]) ">Click</button>
<button onclick="ClikckPoint(pins[6], cities[6]) ">Click</button>
<button onclick="ClikckPoint(pins[7], cities[7]) ">Click</button>
<button onclick="ClikckPoint(pins[8], cities[8]) ">Click</button>
<button onclick="ClikckPoint(pins[9], cities[9]) ">Click</button>
<button onclick="ClikckPoint(pins[10], cities[10]) ">Click</button>
<button onclick="ClikckPoint(pins[11], cities[11]) ">Click</button>
<button onclick="ClikckPoint(pins[12], cities[12]) ">Click</button>
<button onclick="ClikckPoint(pins[13], cities[13]) ">Click</button>
<button onclick="ClikckPoint(pins[14], cities[14]) ">Click</button>
<div class="card" data-background-color="dark">
    <div class="card-header">
        <h4 class="card-title">Nav Pills Without Border (Vertical Tabs)</h4>
    </div>
    <div class="card-body h-auto">
        <div class="row">

            <div class=" col-md-8">
                <div class="tab-content" id="v-pills-without-border-tabContent">
                    <div class="tab-pane fade show active" id="v-pills-home-nobd" role="tabpanel" aria-labelledby="v-pills-home-tab-nobd">

                        <div class="card rounded">
                            <div id="map" style="width: 100%; height: 580px; border-radius:10px  "></div>
                        </div>



                    </div>
                    <div class="tab-pane fade" id="v-pills-profile-nobd" role="tabpanel" aria-labelledby="v-pills-profile-tab-nobd">
                        <p>Even the all-powerful Pointing has no control about the blind texts it is an almost unorthographic life One day however a small line of blind text by the name of Lorem Ipsum decided to leave for the far World of Grammar.</p>
                        <p>
                            The Big Oxmox advised her not to do so, because there were thousands of bad Commas, wild Question Marks and devious Semikoli, but the Little Blind Text didn’t listen. She packed her seven versalia, put her initial into the belt and made herself on the way.
                        </p>
                    </div>
                    <div class="tab-pane fade" id="v-pills-messages-nobd" role="tabpanel" aria-labelledby="v-pills-messages-tab-nobd">
                        <p>Pityful a rethoric question ran over her cheek, then she continued her way. On her way she met a copy. The copy warned the Little Blind Text, that where it came from it would have been rewritten a thousand times and everything that was left from its origin would be the word "and" and the Little Blind Text should turn around and return to its own, safe country.</p>

                        <p> But nothing the copy said could convince her and so it didn’t take long until a few insidious Copy Writers ambushed her, made her drunk with Longe and Parole and dragged her into their agency, where they abused her for their</p>
                    </div>
                </div>
            </div>


            <div class=" col-md-4">
                <div class="row">

                    <div class="col-12" >

                        <div class="nav flex-column nav-pills nav-secondary nav-pills-no-bd" id="v-pills-tab-without-border" role="tablist" aria-orientation="vertical">
                            <a class="nav-link active" id="v-pills-home-tab-nobd" data-bs-toggle="pill" href="#v-pills-home-nobd" role="tab" aria-controls="v-pills-home-nobd" aria-selected="true">Home</a>
                            <a class="nav-link" id="v-pills-profile-tab-nobd" data-bs-toggle="pill" href="#v-pills-profile-nobd" role="tab" aria-controls="v-pills-profile-nobd" aria-selected="false" tabindex="-1">Profile</a>
                            <a class="nav-link" id="v-pills-messages-tab-nobd" data-bs-toggle="pill" href="#v-pills-messages-nobd" role="tab" aria-controls="v-pills-messages-nobd" aria-selected="false" tabindex="-1">Messages</a>
                        </div>

                    </div>
                    <div class="col">

                            <div class="card">
                                <div class="card-header">
                                    <h4 class="card-title">Nav Line</h4>
                                </div>
                                <div class="card-body">
                                    <ul class="nav nav-tabs nav-line nav-color-secondary" id="line-tab" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <a class="nav-link active" id="line-home-tab" data-bs-toggle="pill" href="#line-home" role="tab" aria-controls="pills-home" aria-selected="true">Home</a>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <a class="nav-link" id="line-profile-tab" data-bs-toggle="pill" href="#line-profile" role="tab" aria-controls="pills-profile" aria-selected="false" tabindex="-1">Profile</a>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <a class="nav-link" id="line-contact-tab" data-bs-toggle="pill" href="#line-contact" role="tab" aria-controls="pills-contact" aria-selected="false" tabindex="-1">Contact</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content mt-3 mb-3" id="line-tabContent">
                                        <div class="tab-pane fade show active" id="line-home" role="tabpanel" aria-labelledby="line-home-tab">

                                        <div class="card">
                                            <div class="card-header">
                                                <div class="card-head-row card-tools-still-right">
                                                    <div class="card-title">Recent Activity</div>
                                                    <div class="card-tools">
                                                        <div class="dropdown">
                                                            <button class="btn btn-icon btn-clean" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                <i class="fas fa-ellipsis-h"></i>
                                                            </button>
                                                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                                                <a class="dropdown-item" href="#">Action</a>
                                                                <a class="dropdown-item" href="#">Another action</a>
                                                                <a class="dropdown-item" href="#">Something else here</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <ol class="activity-feed">
                                                    <li class="feed-item feed-item-secondary">
                                                        <time class="date" datetime="9-25">Sep 25</time>
                                                        <span class="text">
                                                            Responded to need
                                                            <a href="#">"Volunteer opportunity"</a>
                                                        </span>
                                                    </li>
                                                    <li class="feed-item feed-item-success">
                                                        <time class="date" datetime="9-24">Sep 24</time>
                                                        <span class="text">
                                                            Added an interest
                                                            <a href="#">"Volunteer Activities"</a>
                                                        </span>
                                                    </li>
                                                    <li class="feed-item feed-item-info">
                                                        <time class="date" datetime="9-23">Sep 23</time>
                                                        <span class="text">
                                                            Joined the group
                                                            <a href="single-group.php">"Boardsmanship Forum"</a>
                                                        </span>
                                                    </li>
                                                    <li class="feed-item feed-item-warning">
                                                        <time class="date" datetime="9-21">Sep 21</time>
                                                        <span class="text">
                                                            Responded to need
                                                            <a href="#">"In-Kind Opportunity"</a>
                                                        </span>
                                                    </li>
                                                    <li class="feed-item feed-item-danger">
                                                        <time class="date" datetime="9-18">Sep 18</time>
                                                        <span class="text">
                                                            Created need
                                                            <a href="#">"Volunteer Opportunity"</a>
                                                        </span>
                                                    </li>
                                                    <li class="feed-item">
                                                        <time class="date" datetime="9-17">Sep 17</time>
                                                        <span class="text">
                                                            Attending the event
                                                            <a href="single-event.php">"Some New Event"</a>
                                                        </span>
                                                    </li>
                                                </ol>
                                            </div>
                                        </div>
                                        
                                        </div>
                                        <div class="tab-pane fade" id="line-profile" role="tabpanel" aria-labelledby="line-profile-tab">
                                            <p>Even the all-powerful Pointing has no control about the blind texts it is an almost unorthographic life One day however a small line of blind text by the name of Lorem Ipsum decided to leave for the far World of Grammar.</p>
                                            <p>
                                                The Big Oxmox advised her not to do so, because there were thousands of bad Commas, wild Question Marks and devious Semikoli, but the Little Blind Text didnâ€™t listen. She packed her seven versalia, put her initial into the belt and made herself on the way.
                                            </p>
                                        </div>
                                        <div class="tab-pane fade" id="line-contact" role="tabpanel" aria-labelledby="line-contact-tab">
                                            <p>Pityful a rethoric question ran over her cheek, then she continued her way. On her way she met a copy. The copy warned the Little Blind Text, that where it came from it would have been rewritten a thousand times and everything that was left from its origin would be the word "and" and the Little Blind Text should turn around and return to its own, safe country.</p>

                                            <p> But nothing the copy said could convince her and so it didnâ€™t take long until a few insidious Copy Writers ambushed her, made her drunk with Longe and Parole and dragged her into their agency, where they abused her for their</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                      


                 

                    </div>

                </div>



            </div>
      
        </div>
    </div>
</div>






@section Scripts {

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <script>
        function CreateMap() {
            // Creating map options
            var mapOptions = {
                center: [34.8021, 38.9968], // Initial center
                zoom: 7, // Initial zoom level
                minZoom: 6.1, // Minimum zoom level
                maxZoom: 8, // Maximum zoom level
                scrollWheelZoom: false, // Disable default scroll zoom
            };
            // Initialize the map
            var map = L.map("map", mapOptions);

            //  map.zoomControl.remove();
            // map.touchZoom.disable();
            // map.doubleClickZoom.disable();
            // map.scrollWheelZoom.disable();
            // map.boxZoom.disable(); // Disable zooming via box selection


            // Add a tile layer
            var layer = L.tileLayer(
                "https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",
                {
                    attribution: "© CartoDB contributors",
                }
            ).addTo(map);
            map.addLayer(layer);

            // Define Syria's geographic bounds
            var syriaBounds = L.latLngBounds(
                L.latLng(32.0, 35.5), // Southwest corner
                L.latLng(37.5, 42.0) // Northeast corner
            );
            //   map.fitBounds(syriaBounds);
            // Set the max bounds to Syria
            map.setMaxBounds(syriaBounds);


            // const test = await fetch("\Home\GetStatiokns")

            // if (test.ok) {
            //     log(test.json()
            // }



            return map;
        }

        function CreateIcon(imageUrl, size) {
            var iconOptions = {
                iconUrl: imageUrl,
                iconSize: size,
            };

            return L.icon(iconOptions);
        }

        var map = CreateMap();

        mainIcon = CreateIcon("/images/map/dot-inside-a-circle-blue.png", [25, 25]);
        hoverIcon = CreateIcon("/images/map/dot-inside-a-circle-yellow.png", [25, 25]);
        clickedIcon = CreateIcon("/images/map/dot-inside-a-circle.png", [25, 25]);

        let selectedCities = [];
        // Draw route lines
        let polyline = null;
        function drawRoute() {
            // Remove the existing route
            if (polyline) {
                map.removeLayer(polyline);
            }

            // Create a new route with selected cities
            if (selectedCities.length > 1) {
                const latlngs = selectedCities.map((city) => [city.latitude, city.longitude]);
                polyline = L.polyline(latlngs, { color: "red" }).addTo(map);
            }
        }

        // Add event listener for scroll events
        map.getContainer().addEventListener("wheel", (event) => {
            if (!event.ctrlKey) {
              
            } else {
                // Allow zoom if Ctrl is pressed
                map.scrollWheelZoom.enable();
                setTimeout(() => {
                    map.scrollWheelZoom.disable();
                }, 50); // Re-disable zoom after a short delay
                event.preventDefault(); // Prevent default scroll to enable zoom
            }
        });

        function ClikckPoint(pin, city) {

           
            const index = selectedCities.findIndex((c) => c.stationName === city.stationName);

            if (index === -1) {
                pin.setIcon(clickedIcon);

                selectedCities.push(city);
                pin.isSelected = true;
            } else {
                if (index === selectedCities.length - 1) {
                    pin.setIcon(mainIcon);
                    selectedCities.splice(index, 1);
                    pin.isSelected = false;
                }
            }
            pin.closePopup();
            drawRoute();
        }

        let pins = [];
        let cities;
        async function AddEventsToPoints() {

            let response = await fetch("FetchAllStations");

            if (response.ok) {

                cities = await response.json();
       
                cities.forEach(function (city) {
                    var pin = L.marker([city.latitude, city.longitude], { icon: mainIcon });
                    pins.push(pin);

                    pin.addTo(map);

                    pin.on("mouseover", function () {
                        pin.bindPopup(city.stationName).openPopup();
                        if (!pin.isSelected) {
                            pin.setIcon(hoverIcon);
                        }
                    });

                    pin.on("mouseout", function () {
                        if (!pin.isSelected) {
                            pin.setIcon(mainIcon);
                        }
                        pin.closePopup();
                    });

                    pin.on("click",()=> ClikckPoint(pin,city));
                });


            }
                   
            
        }
       
        AddEventsToPoints();

    </script>


}







